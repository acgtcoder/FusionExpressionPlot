---
title: "Graphics examples with fusionExpressionPlot"
author: "Stuart R. Jefferys"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Graphics examples with fusionExpressionPlot}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## GRange data objects

Most fusionExpression plot functions expect data to be packaged as genomicRanges
objects. These are not much different from data frames, but have lots of useful
features. (For details see [TODO Link to info about GRange objects].) We are
only using a few of those features, and have wrapped some of the behavior in
convienience functions. As used in this package, a GRange object represents the
exon start and stop points of one genomic object (gene, transcript, fusion end, etc)
on one strand of one chromosome. Multiple features (such as a list of genes or a two-ended fusion)
require multiple GRange objects to describe. These are passed separately or in lists.

### Creating a new GRange object from a list of exons
```{r}
grNew(
   start= c( 101, 301, 511, 513, 813 ),
   end= c( 200, 500, 511, 612, 822 ),
   chr= "chr1",
   strand= "+"
)
```

```{r}
makeClownGr <- function() {
   gr <- GRanges(
      ranges= IRanges( start= c( 101, 301, 511, 513, 813 ), end= c( 200, 500, 511, 612, 822 )),
      seqnames= c( "chr1" ),
      strand= c( "+" )
   );
   gr <- grAddColumn(gr, 'exonFillColor', c('red', 'orange', 'yellow', 'green', 'blue'));
   gr <- grAddColumn(gr, 'exonBorderColor', c('blue', 'green', 'black', 'orange', 'red'));
   gr <- grAddColumn(gr, 'exonHeight', c(50, 100, 200, 100, 50));
   return(gr);
}

makeClownGr()
```


```{r}
demo.makeGrForTmprss2 <- function() {
   exons <- "42836479-42838080,42839661-42839813,42840323-42840465,42842575-42842670,42843733-42843908,42845252-42845423,42848504-42848547,42851099-42851209,42852403-42852529,42860321-42860440,42861434-42861520,42866283-42866505,42870046-42870116,42879877-42879992";
   iRanges <- IRanges(
      start= as.numeric(sub("-.+", "", unlist(strsplit(exons, ",")))),
      end=   as.numeric(sub(".+-", "", unlist(strsplit(exons, ","))))
   );
   gr <- GRanges(
      seqnames <- as.factor( "chr21" ),
      ranges   <- iRanges,
      strand   <- '-'
   );
   return( gr )
}
```

## Figures

The figure sizes have been customised so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```

You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.
